"TOWNSHIP 18", "TOWNSHIP 17", "TOWNSHIP 16", "TOWNSHIP 15",
"TOWNSHIP 14", "TOWNSHIP 13", "TOWNSHIP 12", "TOWNSHIP 11",
"TOWNSHIP 10", "TOWNSHIP 9", "TOWNSHIP 8", "TOWNSHIP 7",
"TOWNSHIP 5", "TOWNSHIP 4", "TOWNSHIP 3", "TOWNSHIP 2",
"TOWNSHIP 1",
"LOT 64", "LOT 63", "LOT 61", "LOT 59", "LOT 66", "LOT 53",
"LOT 54", "LOT 55", "LOT 56", "LOT 43", "LOT 44", "LOT 45",
"LOT 46", "LOT 40", "LOT 39", "LOT 38", "LOT 62", "LOT 60",
"LOT 58", "LOT 57", "LOT 48", "LOT 49", "LOT 67", "LOT 29",
"LOT 20", "LOT 21", "LOT 22", "LOT 23", "LOT 24", "LOT 33",
"LOT 34", "LOT 35", "LOT 36", "LOT 28", "LOT 26", "LOT 25",
"LOT 18", "LOT 17", "LOT 16", "LOT 15", "LOT 14", "LOT 13",
"LOT 12", "LOT 11", "LOT 10", "LOT 9", "LOT 8", "LOT 7",
"LOT 5", "LOT 4", "LOT 3", "LOT 2", "LOT 1"
)
# Chunk 8
subdivisions_cotieres_nb <- c(
"SAINT MARTINS", "ST. MARTINS", "SIMONDS", "SAINT JOHN",
"MUSQUASH", "GRAND MANAN", "SEAL COVE", "NORTH HEAD",
"CAMPOBELLO", "WEST ISLES", "LEPREAU", "PENNFIELD",
"BLACKS HARBOUR", "CLARENDON", "SAINT GEORGE", "ST. GEORGE",
"SAINT PATRICK", "SAINT ANDREWS", "SAINT ANDREWS",
"SAINT-CROIX", "DUFFERIN", "SAINT STEPHEN", "ST. STEPHEN",
"SAINT JAMES", "SAINT DAVID", "DUMBARTON", "GRAND HARBOUR",
"HAMMOND", "UPHAM", "HAMPTON", "HAMPTON", "ROTHESAY",
"ROTHESAY", "RENFORTH", "WESTFIELD", "GRAND BAY",
"WESTFIELD",
"KINGSTON", "QUISPAMSIS", "GONDOLA POINT", "HOPEWELL",
"RIVERSIDE-ALBERT", "HARVEY", "ALMA", "ALMA", "HILLSBOROUGH",
"COVERDALE", "RIVERVIEW", "HILLSBOROUGH", "WESTMORLAND",
"PORT ELGIN", "BOTSFORD", "CAP-PELE", "SACKVILLE",
"SACKVILLE", "DORCHESTER", "DORCHESTER", "SHEDIAC",
"MONCTON",
"MONCTON", "SHEDIAC", "RICHIBUCTO", "RICHIBUCTO", "REXTON",
"SAINT CHARLES", "SAINT-LOUIS", "SAINT-LOUIS-DE-KENT",
"CARLETON", "HARDWICKE", "GLENELG", "CHATHAM",
"CHATHAM", "DERBY", "NELSON", "NELSON-MIRAMICHI",
"BLACKVILLE", "BLACKVILLE", "DOAKTOWN", "LUDLOW",
"RED BANK 7", "SOUTHESK", "NORTHESK", "NEWCASTLE",
"NEWCASTLE", "DOUGLASTOWN", "EEL GROUND 2", "ALNWICK",
"NEGUAC", "BURNT CHURCH 14", "TABUSINTAC 9", "JACQUET RIVER",
"COLBORNE", "CHARLO", "BALMORAL", "BALMORAL",
"DALHOUSIE", "DALHOUSIE", "EEL RIVER 3", "EEL RIVER
CROSSING",
"CAMPBELLTON", "TIDE HEAD", "BERESFORD", "POINTE-VERTE",
"PETIT-ROCHER", "BERESFORD", "NEW BANDON", "PAQUETVILLE",
"PAQUETVILLE", "SAINT-ISIDORE", "INKERMAN", "CARAQUET",
"BAS-CARAQUET", "CARAQUET", "SHIPPAGAN", "SHIPPAGAN",
"LAMEQUE", "BELLEDUNE", "BERTRAND", "NIGADOO", "GRANDE ANSE",   "GRANDE-ANSE", "MAISONNETTE"
)
# Chunk 9
subdivisions_cotieres_bc <- c(
"SURREY", "WHITE ROCK", "DELTA", "RICHMOND", "UNIVERSITY ENDOWMENT AREA", "VANCOUVER",
"C NORTH SAANICH", "SIDNEY", "CENTRAL SAANICH", "SAANICH", "CAPITAL", "SUBD. A",
"OAK BAY", "VICTORIA", "ESQUIMALT", "CAPITAL", "SUBD. B", "CAPITAL", "SUBD. C",
"COLE BAY 3", "UNION BAY 4", "EAST SAANICH 2", "SOUTH SAANICH 1", "GALIANO ISLAND 9",
"MAYNE ISLAND 6", "BECHER BAY 1", "BECHER BAY 2", "NEW SONGHEES 1A", "GORDON RIVER 2",
"PACHEENA 1", "SOOKE 1", "BURNABY", "NEW WESTMINSTER", "COQUITLAM", "BELCARRA",
"PORT COQUITLAM", "PORT MOODY", "NORTH VANCOUVER", "WEST VANCOUVER", "GREATER VANCOUVER",
"SUBD. A", "LIONS BAY", "SEMIAHMOO", "TSAWWASSEN", "MUSQUEAM 2", "COQUITLAM 2",
"COQUITLAM 1", "BURRARD INLET 3", "MISSION 1", "CAPILANO 5", "BARNSTON ISLAND 3",
"NORTH COWICHAN", "DUNCAN", "LAKE COWICHAN", "LADYSMITH", "COWICHAN VALLEY", "SUBD. A",
"HALALT 2", "SQUAW-HAY-ONE 11", "TSUSSIE 6", "CHEMAINUS 13", "CLAOOSE 4", "COWICHAN 9",
"COWICHAN 1", "KIL-PAH-LAS 3", "KUPER ISLAND 7", "MALACHAN 11", "MALAHAT 11",
"OYSTER BAY 12", "PORTIER PASS 5", "THEIK 2", "WYAH 3", "NANAIMO", "NANAIMO", "SUBD. A",
"PARKSVILLE", "QUALICUM BEACH", "NANAIMO", "SUBD. B", "NANAIMO RIVER 3",
"NANAIMO RIVER 2", "NANAIMO RIVER 4", "NANAIMO TOWN 1", "NANOOSE", "QUALICUM",
"PORT ALBERNI", "UCLUELET", "TOFINO", "ALBERNI-CLAYOQUOT", "SUBD. A", "AHAHSWINIS 1",
"ALBERNI 2", "ANACLA 12", "CLAKAMUCUS 2", "ELHLATEESE 2", "HESQUIAT 1", "ITTATSOO 1",
"MARKTOSIS 15", "NUMUKAMIS 1", "OPENIT 27", "OPITSAT 1", "SACHSA 4", "STUART BAY 6",
"TSAHAHEH 1", "KEESHAN 9", "KLEHKOOT 2", "ESOWISTA 3", "REFUGE COVE 6", "COMOX",
"COURTENAY", "CUMBERLAND", "COMOX-STRATHCONA", "SUBD. C", "GOLD RIVER", "ZEBALLOS",
"TAHSIS", "CAMPBELL RIVER", "SAYWARD", "COMOX-STRATHCONA", "SUBD. B",
"COMOX-STRATHCONA", "SUBD. A", "COMOX 1", "PENTLEDGE 2", "AHAMINAQUUS 12",
"CAMPBELL RIVER 11", "CHENAHKINT 12", "HOUPSITAS 6", "MISSION ISLAND 2", "NUCHATL 2",
"NUCHATL 1", "QUINSAM 12", "VILLAGE ISLAND 1", "YUQUOT 1", "AUPE 6", "AUPE 6A",
"CAPE MUDGE 10", "SQUIRREL COVE 8", "TATPO-OOSE 10", "TORK 7", "POWELL RIVER",
"POWELL RIVER", "SUBD. A", "SLIAMMON 1", "HARWOOD ISLAND 2", "GIBSONS", "SECHELT",
"SUNSHINE COAST", "SUBD. A", "CHEKWELP 26", "CHEKWELP 26A", "SESHELT 2", "ALERT BAY",
"PORT MCNEIL", "PORT ALICE", "PORT HARDY", "MOUNT WADDINGTON", "SUBD. B",
"MOUNT WADDINGTON", "SUBD. A", "ALERT BAY 1", "ALERT BAY 1A", "CHES-LA-KEE 3",
"FORT RUPERT 1", "QUATTISHE 1", "TSULQUATE 4", "DEAD POINT 5", "GWAYASDUMS 1",
"HOPETOWN 10A", "KARLUKWEES 1", "MAHMALILLIKULLAH 1", "PAHAS 3", "QUAEE 7",
"KIPPASE 2", "QUATSINO SUBDIVISION 18", "CENTRAL COAST", "SUBD. A", "BELLA BELLA 1",
"BELLA COOLA 1", "KATIT 1", "PORT EDWARD", "PRINCE RUPERT", "SKEENA-QUEEN CHARLOTTE",
"SUBD. A", "MASSET", "SKEENA-QUEEN CHARLOTTE", "SUBD. B", "PORT CLEMENTS",
"PORT SIMPSON 1", "TSIMPSEAN 2", "MASSET 1", "SKIDEGATE 1", "KITIMAT", "TERRACE",
"KITIMAT-STIKINE", "SUBD. C", "HAZELTON", "NEW HAZELTON", "KITIMAT-STIKINE",
"SUBD. B", "STEWART", "KITIMAT-STIKINE", "SUBD. A", "DOLPHIN ISLAND 1", "KITASOO 1",
"KITIMAT 1", "KITSUMKAYLUM 1", "KSHISH 4", "KULKAYU 4", "KULSPAI 6", "CORYATSAQUA 2",
"HAGWILGET 1", "GITANMAAX 1", "KISPIOX 1", "KITSEGUECLA 1", "KITWANCOOL 1",
"KITWANGAR 1", "MORICETOWN 1", "SIK-E-DAKH 2", "AIYANSH 1", "KINCOLITH 14",
"KITWILLUCHSILT 7", "LACHKALTSAP 9", "TELEGRAPH CREEK 6", "NEW AIYANSH 1",
"KLUACHON LAKE 1"
)
# Chunk 10
base_clean <- base |>
mutate(group = case_when(
Prov_Name == "Newfoundland and Labrador" &
toupper(CSD_Name) %in% subdivisions_cotieres_nl ~ "T",
Prov_Name == "Prince Edward Island" &
toupper(CSD_Name) %in% subdivisions_cotieres_pei ~ "C",
Prov_Name == "New Brunswick" &
toupper(CSD_Name) %in% subdivisions_cotieres_nb ~ "C",
Prov_Name == "British Columbia" &
toupper(CSD_Name) %in% subdivisions_cotieres_bc ~ "C",
TRUE ~ NA_character_
)) |>
filter(group %in% c("C", "T"))
# Chunk 11
# Boxplots
boxplot(base_clean$total_postsec_ratio)
boxplot(base_clean$trade_cert_ratio)
boxplot(base_clean$non_uni_dip_ratio)
boxplot(base_clean$uni_dip_ratio)
boxplot(base_clean$median_income)
boxplot(base_clean$female_ratio)
boxplot(base_clean$a0_14_ratio)
boxplot(base_clean$a15_24_ratio)
boxplot(base_clean$a25_over_ratio)
boxplot(base_clean$non_movers_ratio)
boxplot(base_clean$primary_ind_ratio)
# Test de Rosner
rosnerTest(base_clean$total_postsec_ratio, k = 20, alpha = 0.05) # 3
rosnerTest(base_clean$trade_cert_ratio, k = 30, alpha = 0.05) # 17
rosnerTest(base_clean$non_uni_dip_ratio, k = 15, alpha = 0.05) # 8
rosnerTest(base_clean$uni_dip_ratio, k = 50, alpha = 0.05) # 38
rosnerTest(base_clean$median_income, k = 20, alpha = 0.05) # 2
rosnerTest(base_clean$female_ratio, k = 50, alpha = 0.05) # 34
rosnerTest(base_clean$a0_14_ratio, k = 20, alpha = 0.05) # 11
rosnerTest(base_clean$a15_24_ratio, k = 20, alpha = 0.05) # 4
rosnerTest(base_clean$a25_over_ratio, k = 100, alpha = 0.05) # 78
rosnerTest(base_clean$non_movers_ratio, k = 20, alpha = 0.05) # 1
rosnerTest(base_clean$primary_ind_ratio, k = 20, alpha = 0.05) # 5
# 201 valeurs atypiques dans une base de 3496 observations soit 5.8% des données
# Code pour les supprimer ainsi que les 318 valeurs manquantes (201 + 318 = 519)
base_clean_2 <- base_clean |>
filter(
!is.na(total_postsec_ratio) & total_postsec_ratio < 1,
!is.na(trade_cert_ratio) & trade_cert_ratio < 0.3613,
!is.na(non_uni_dip_ratio) & non_uni_dip_ratio < 0.48,
!is.na(uni_dip_ratio) & uni_dip_ratio < 0.3061,
!is.na(median_income) & median_income < 100995,
!is.na(female_ratio) & female_ratio < 0.6154 & female_ratio > 0.3684,
!is.na(a0_14_ratio) & a0_14_ratio < 0.5714,
!is.na(a15_24_ratio) & a15_24_ratio < 0.4483,
!is.na(a25_over_ratio) & a25_over_ratio < 1.1250 & a25_over_ratio > 0.1429,
!is.na(non_movers_ratio) & non_movers_ratio > 0,
!is.na(primary_ind_ratio) & primary_ind_ratio < 0.7059
)
# Revérification
rosnerTest(base_clean_2$total_postsec_ratio, k = 20, alpha = 0.05) # 0
rosnerTest(base_clean_2$trade_cert_ratio, k = 30, alpha = 0.05) # 0
rosnerTest(base_clean_2$non_uni_dip_ratio, k = 15, alpha = 0.05) # 0
rosnerTest(base_clean_2$uni_dip_ratio, k = 50, alpha = 0.05) # 0
rosnerTest(base_clean_2$median_income, k = 20, alpha = 0.05) # 0
rosnerTest(base_clean_2$female_ratio, k = 50, alpha = 0.05) # 5
rosnerTest(base_clean_2$a0_14_ratio, k = 20, alpha = 0.05) # 1
rosnerTest(base_clean_2$a15_24_ratio, k = 20, alpha = 0.05) # 3
rosnerTest(base_clean_2$a25_over_ratio, k = 20, alpha = 0.05) # 0
rosnerTest(base_clean_2$non_movers_ratio, k = 20, alpha = 0.05) # 0
rosnerTest(base_clean_2$primary_ind_ratio, k = 20, alpha = 0.05) # 1
# Correction
base_clean_3<-base_clean_2[(base_clean_2$female_ratio<0.6095)
&(base_clean_2$female_ratio>0.3750)
&(base_clean_2$a0_14_ratio<0.5455)
&(base_clean_2$a15_24_ratio<0.4)
&(base_clean_2$a25_over_ratio<1.0241)
&(base_clean_2$non_movers_ratio<1)
&(base_clean_2$primary_ind_ratio<0.6923),]
# Dernière vérification
rosnerTest(base_clean_3$total_postsec_ratio, k = 20, alpha = 0.05) # 0
rosnerTest(base_clean_3$trade_cert_ratio, k = 20, alpha = 0.05) # 0
rosnerTest(base_clean_3$non_uni_dip_ratio, k = 15, alpha = 0.05) # 0
rosnerTest(base_clean_3$uni_dip_ratio, k = 20, alpha = 0.05) # 0
rosnerTest(base_clean_3$median_income, k = 20, alpha = 0.05) # 0
rosnerTest(base_clean_3$female_ratio, k = 20, alpha = 0.05) # 0
rosnerTest(base_clean_3$a0_14_ratio, k = 20, alpha = 0.05) # 0
rosnerTest(base_clean_3$a15_24_ratio, k = 20, alpha = 0.05) # 0
rosnerTest(base_clean_3$a25_over_ratio, k = 20, alpha = 0.05) # 0
rosnerTest(base_clean_3$non_movers_ratio, k = 20, alpha = 0.05) # 0
rosnerTest(base_clean_3$primary_ind_ratio, k = 20, alpha = 0.05) # 0
# Plus de valeurs atypiques
# Chunk 12
# library(PerformanceAnalytics)
mydata <- base_clean_3[, c("median_income","female_ratio",
"a0_14_ratio","a15_24_ratio",
"a25_over_ratio","non_movers_ratio", "primary_ind_ratio")]
corr_mat=cor(mydata,method="s")
corrplot(corr_mat, method = 'color',type="upper")
corrplot(corr_mat, method = 'number',type="upper")
# Chunk 13
par(mfrow=c(2,2))
hist(base_clean_3$total_postsec_ratio, xlab="Total Post-Secondary Education", main=" ", col="paleturquoise")
hist(base_clean_3$trade_cert_ratio, xlab="Trade Certificates", main=" ", col="lightpink")
hist(base_clean_3$non_uni_dip_ratio, xlab="Non-University Diplomas", main=" ", col="lightgoldenrod1")
hist(base_clean_3$uni_dip_ratio, xlab="University Diplomas", main=" ", col="palegreen")
par(mfrow=c(1,1))
hist(base_clean_3$median_income, xlab="Median Income", main=" ", col="grey")
hist(base_clean_3$female_ratio, xlab="Female Population", main=" ", col="grey")
hist(base_clean_3$a0_14_ratio, xlab="Age 0 to 14", main=" ", col="grey")
hist(base_clean_3$a15_24_ratio, xlab="Age 15 to 24", main=" ", col="grey")
hist(base_clean_3$a25_over_ratio, xlab="Age 25 and over", main=" ", col="grey")
hist(base_clean_3$non_movers_ratio, xlab="Non-movers", main=" ", col="grey")
hist(base_clean_3$primary_ind_ratio, xlab="Age 0 to 14", main=" ", col="grey")
# Chunk 14
# Min., 1st Qu., Median, Mean, 3rd Qu., Max.
summary(base_clean_3$total_postsec_ratio)
summary(base_clean_3$trade_cert_ratio)
summary(base_clean_3$non_uni_dip_ratio)
summary(base_clean_3$uni_dip_ratio)
summary(base_clean_3$median_income)
summary(base_clean_3$female_ratio)
summary(base_clean_3$a0_14_ratio)
summary(base_clean_3$a15_24_ratio)
summary(base_clean_3$a25_over_ratio)
summary(base_clean_3$non_movers_ratio)
summary(base_clean_3$primary_ind_ratio)
# Standard Deviation
sd(base_clean_3$total_postsec_ratio)
sd(base_clean_3$trade_cert_ratio)
sd(base_clean_3$non_uni_dip_ratio)
sd(base_clean_3$uni_dip_ratio)
sd(base_clean_3$median_income)
sd(base_clean_3$female_ratio)
sd(base_clean_3$a0_14_ratio)
sd(base_clean_3$a15_24_ratio)
sd(base_clean_3$a25_over_ratio)
sd(base_clean_3$non_movers_ratio)
sd(base_clean_3$primary_ind_ratio)
# Chunk 15
# C = synthétique
base_total <- base_clean_3
# Création des variables pertinentes pour la DiD
base_total <- base_total |>
mutate(
treated = ifelse(Prov_Name == "Newfoundland and Labrador", 1, 0),
post = ifelse(period == 1, 1, 0),
did = treated * post
)
# C = New Brunswick
base_nb <- base_total |>
filter(Prov_Name %in% c("Newfoundland and Labrador", "New Brunswick"))
# C = Prince Edward Island
base_pei <- base_total |>
filter(Prov_Name %in% c("Newfoundland and Labrador", "Prince Edward Island"))
# C = British Columbia
base_bc <- base_total |>
filter(Prov_Name %in% c("Newfoundland and Labrador", "British Columbia"))
# C = Nova Scotia
# base_ns <- base_total |>
#  filter(Prov_Name %in% c("Newfoundland and Labrador", "Nova Scotia"))
# Chunk 16
# Années présentes dans les données
annees_observees <- c(1981, 1986, 1991, 1996, 2001, 2006)
# Chunk 17
# Variables à tracer
vars <- c("total_postsec_ratio", "trade_cert_ratio", "uni_dip_ratio", "non_uni_dip_ratio")
# Fonction pour générer un graphique par variable
plot_func <- function(var_name) {
data_plot <- base_nb %>%
filter(Prov_Name %in% c("Newfoundland and Labrador", "New Brunswick")) %>%
group_by(year, Prov_Name) %>%
summarise(mean_value = mean(.data[[var_name]], na.rm = TRUE), .groups = "drop")
ggplot(data_plot, aes(x = year, y = mean_value, color = Prov_Name)) +
geom_line(size = 1.2) +
geom_point() +
geom_vline(xintercept = 1992, linetype = "dashed", color = "black") +
scale_x_continuous(breaks = annees_observees) +
labs(
title = paste(var_name, "trends before and after the 1992 moratorium"),
x = "Year",
y = "Average Rate",
color = "Province"
) +
theme_classic()
}
# Créer les graphiques et les stocker dans une liste
plots <- map(vars, plot_func)
# Afficher tous les graphiques (si tu utilises RStudio)
plots[[1]]
plots[[2]]
plots[[3]]
plots[[4]]
# Chunk 18
# Fonction pour générer un graphique par variable
plot_func <- function(var_name) {
data_plot <- base_pei %>%
filter(Prov_Name %in% c("Newfoundland and Labrador", "Prince Edward Island")) %>%
group_by(year, Prov_Name) %>%
summarise(mean_value = mean(.data[[var_name]], na.rm = TRUE), .groups = "drop")
ggplot(data_plot, aes(x = year, y = mean_value, color = Prov_Name)) +
geom_line(size = 1.2) +
geom_point() +
geom_vline(xintercept = 1992, linetype = "dashed", color = "black") +
scale_x_continuous(breaks = annees_observees) +
labs(
title = paste(var_name, "trends before and after the 1992 moratorium"),
x = "Year",
y = "Annual Rate",
color = "Province"
) +
theme_classic()
}
# Créer les graphiques et les stocker dans une liste
plots <- map(vars, plot_func)
# Afficher tous les graphiques (si tu utilises RStudio)
plots[[1]]
plots[[2]]
plots[[3]]
plots[[4]]
# Chunk 19
plot_func <- function(var_name) {
data_plot <- base_pei %>%
filter(Prov_Name %in% c("Newfoundland and Labrador", "Prince Edward Island")) %>%
group_by(year, Prov_Name) %>%
summarise(mean_value = mean(.data[[var_name]], na.rm = TRUE), .groups = "drop")
ggplot(data_plot, aes(x = year, y = mean_value, color = Prov_Name)) +
geom_line(size = 1.2) +
geom_point() +
geom_vline(xintercept = 1992, linetype = "dashed", color = "black") +
scale_x_continuous(breaks = annees_observees) +
scale_color_manual(
values = c(
"Prince Edward Island" = "lightcoral",
"Newfoundland and Labrador" = "mediumturquoise"
)
) +
labs(
title = paste(var_name, "trends before and after the 1992 moratorium"),
x = "Year",
y = "Annual Rate",
color = "Province"
) +
theme_classic()
}
# Créer les graphiques et les stocker dans une liste
plots <- map(vars, plot_func)
# Afficher tous les graphiques
plots[[1]]
plots[[2]]
plots[[3]]
plots[[4]]
# Chunk 20
# Fonction pour générer un graphique par variable
plot_func <- function(var_name) {
data_plot <- base_bc %>%
filter(Prov_Name %in% c("Newfoundland and Labrador", "British Columbia")) %>%
group_by(year, Prov_Name) %>%
summarise(mean_value = mean(.data[[var_name]], na.rm = TRUE), .groups = "drop")
ggplot(data_plot, aes(x = year, y = mean_value, color = Prov_Name)) +
geom_line(size = 1.2) +
geom_point() +
geom_vline(xintercept = 1992, linetype = "dashed", color = "black") +
scale_x_continuous(breaks = annees_observees) +
labs(
title = paste(var_name, "trends before and after the 1992 moratorium"),
x = "Year",
y = "Average Rate",
color = "Province"
) +
theme_classic()
}
# Créer les graphiques et les stocker dans une liste
plots <- map(vars, plot_func)
# Afficher tous les graphiques (si tu utilises RStudio)
plots[[1]]
plots[[2]]
plots[[3]]
plots[[4]]
# Chunk 21
# Fonction pour générer un graphique par variable
plot_func <- function(var_name) {
data_plot <- base_total %>%
group_by(year, group) %>%
summarise(mean_value = mean(.data[[var_name]], na.rm = TRUE), .groups = "drop")
ggplot(data_plot, aes(x = year, y = mean_value, color = group)) +
geom_line(size = 1.2) +
geom_point() +
geom_vline(xintercept = 1992, linetype = "dashed", color = "black") +
scale_x_continuous(breaks = annees_observees) +
labs(
title = paste(var_name, "trends before and after the 1992 moratorium"),
x = "Year",
y = "Average Rate",
color = "Province"
) +
theme_classic()
}
# Créer les graphiques et les stocker dans une liste
plots <- map(vars, plot_func)
# Afficher tous les graphiques
plots[[1]]
plots[[2]]
plots[[3]]
plots[[4]]
synth_simple <- lm(total_postsec_ratio ~ treated + post + did, data = base_total)
summary(synth_simple)
synth_simple_2 <- lm(trade_cert_ratio ~ treated + post + did, data = base_total)
summary(synth_simple_2)
synth_simple_3 <- lm(non_uni_dip_ratio ~ treated + post + did, data = base_total)
summary(synth_simple_3)
synth_simple_4 <- lm(uni_dip_ratio ~ treated + post + did, data = base_total)
summary(synth_simple_4)
synth_control <- lm(total_postsec_ratio ~ treated + post + did +
median_income + female_ratio + a15_24_ratio + a25_over_ratio
+ non_movers_ratio + primary_ind_ratio, data = base_total)
summary(synth_control)
synth_control_2 <- lm(trade_cert_ratio ~ treated + post + did +
median_income + female_ratio + a15_24_ratio + a25_over_ratio
+ non_movers_ratio + primary_ind_ratio, data = base_total)
summary(synth_control_2)
synth_control_3 <- lm(non_uni_dip_ratio ~ treated + post + did +
median_income + female_ratio + a15_24_ratio + a25_over_ratio
+ non_movers_ratio + primary_ind_ratio, data = base_total)
summary(synth_control_3)
synth_control_4 <- lm(uni_dip_ratio ~ treated + post + did +
median_income + female_ratio + a15_24_ratio + a25_over_ratio
+ non_movers_ratio + primary_ind_ratio, data = base_total)
summary(synth_control_4)
nb_simple <- lm(total_postsec_ratio ~ treated + post + did, data = base_nb)
summary(nb_simple)
nb_simple_2 <- lm(trade_cert_ratio ~ treated + post + did, data = base_nb)
summary(nb_simple_2)
nb_simple_3 <- lm(non_uni_dip_ratio ~ treated + post + did, data = base_nb)
summary(nb_simple_3)
nb_simple_4 <- lm(uni_dip_ratio ~ treated + post + did, data = base_nb)
summary(nb_simple_4)
nb_control <- lm(total_postsec_ratio ~ treated + post + did +
median_income + female_ratio + a15_24_ratio + a25_over_ratio
+ non_movers_ratio + primary_ind_ratio, data = base_nb)
summary(nb_control)
nb_control_2 <- lm(trade_cert_ratio ~ treated + post + did +
median_income + female_ratio + a15_24_ratio + a25_over_ratio
+ non_movers_ratio + primary_ind_ratio, data = base_nb)
summary(nb_control_2)
nb_control_3 <- lm(non_uni_dip_ratio ~ treated + post + did +
median_income + female_ratio + a15_24_ratio + a25_over_ratio
+ non_movers_ratio + primary_ind_ratio, data = base_nb)
summary(nb_control_3)
nb_control_4 <- lm(uni_dip_ratio ~ treated + post + did +
median_income + female_ratio + a15_24_ratio + a25_over_ratio
+ non_movers_ratio + primary_ind_ratio, data = base_nb)
summary(nb_control_4)
pei_simple <- lm(total_postsec_ratio ~ treated + post + did, data = base_pei)
summary(pei_simple)
pei_simple_2 <- lm(trade_cert_ratio ~ treated + post + did, data = base_pei)
summary(pei_simple_2)
pei_simple_3 <- lm(non_uni_dip_ratio ~ treated + post + did, data = base_pei)
summary(pei_simple_3)
pei_simple_4 <- lm(uni_dip_ratio ~ treated + post + did, data = base_pei)
summary(pei_simple_4)
pei_control <- lm(total_postsec_ratio ~ treated + post + did +
median_income + female_ratio + a15_24_ratio + a25_over_ratio
+ non_movers_ratio + primary_ind_ratio, data = base_pei)
summary(pei_control)
pei_control_2 <- lm(trade_cert_ratio ~ treated + post + did +
median_income + female_ratio + a15_24_ratio + a25_over_ratio
+ non_movers_ratio + primary_ind_ratio, data = base_pei)
summary(pei_control_2)
pei_control_3 <- lm(non_uni_dip_ratio ~ treated + post + did +
median_income + female_ratio + a15_24_ratio + a25_over_ratio
+ non_movers_ratio + primary_ind_ratio, data = base_pei)
summary(pei_control_3)
pei_control_4 <- lm(uni_dip_ratio ~ treated + post + did +
median_income + female_ratio + a15_24_ratio + a25_over_ratio
+ non_movers_ratio + primary_ind_ratio, data = base_pei)
summary(pei_control_4)
bc_simple <- lm(total_postsec_ratio ~ treated + post + did, data = base_bc)
summary(bc_simple)
bc_simple_2 <- lm(trade_cert_ratio ~ treated + post + did, data = base_bc)
summary(bc_simple_2)
bc_simple_3 <- lm(non_uni_dip_ratio ~ treated + post + did, data = base_bc)
summary(bc_simple_3)
bc_simple_4 <- lm(uni_dip_ratio ~ treated + post + did, data = base_bc)
summary(bc_simple_4)
bc_control <- lm(total_postsec_ratio ~ treated + post + did +
median_income + female_ratio + a15_24_ratio + a25_over_ratio
+ non_movers_ratio + primary_ind_ratio, data = base_bc)
summary(bc_control)
bc_control_2 <- lm(trade_cert_ratio ~ treated + post + did +
median_income + female_ratio + a15_24_ratio + a25_over_ratio
+ non_movers_ratio + primary_ind_ratio, data = base_bc)
summary(bc_control_2)
bc_control_3 <- lm(non_uni_dip_ratio ~ treated + post + did +
median_income + female_ratio + a15_24_ratio + a25_over_ratio
+ non_movers_ratio + primary_ind_ratio, data = base_bc)
summary(bc_control_3)
bc_control_4 <- lm(uni_dip_ratio ~ treated + post + did +
median_income + female_ratio + a15_24_ratio + a25_over_ratio
+ non_movers_ratio + primary_ind_ratio, data = base_bc)
summary(bc_control_4)
summary(synth_control)
synth_control_test <- lm(uni_dip_ratio ~ treated + post + did +
did * a_15_24_ratio
median_income + female_ratio + a15_24_ratio + a25_over_ratio
synth_control_test <- lm(uni_dip_ratio ~ treated + post + did +
did * a_15_24_ratio +
median_income + female_ratio + a15_24_ratio + a25_over_ratio
+ non_movers_ratio + primary_ind_ratio, data = base_total)
synth_control_test <- lm(uni_dip_ratio ~ treated + post + did +
did * a15_24_ratio +
median_income + female_ratio + a15_24_ratio + a25_over_ratio
+ non_movers_ratio + primary_ind_ratio, data = base_total)
summary(synth_control_test)
summary(synth_control)
summary(synth_control_test)
synth_control_test <- lm(uni_dip_ratio ~ treated + post + did +
did * a25_over_ratio +
median_income + female_ratio + a15_24_ratio + a25_over_ratio
+ non_movers_ratio + primary_ind_ratio, data = base_total)
summary(synth_control_test)
